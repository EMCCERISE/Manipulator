<?xml version="1.0"?>

<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="arduinobot_description">

	<!-- Load Simulated or Real Hardware Interfaces -->
    <xacro:arg name="is_sim" default="true"/>

    <!-- Include Gazebo Parameters -->
    <xacro:include filename="$(find arduinobot_description)/urdf/servo6dof_gazebo.xacro" />

    <!-- Include ros2_control Plugins -->
    <xacro:include filename="$(find arduinobot_description)/urdf/servo6dof_ros2_control.xacro" />
	
	<xacro:property name="PI" value="3.14159"/>
	<xacro:property name="effort" value="30.0"/>
	<xacro:property name="velocity" value="10.0"/>

	<!-- Useful Macros -->
    <xacro:macro name="default_inertial" params="mass">
        <inertial>
            <origin xyz="0 0 0" rpy="0 0 0"/>
            <mass value="${mass}" />
            <inertia ixx="1.0" ixy="0.0" ixz="0.0"
                     iyy="1.0" iyz="0.0"
                     izz="1.0" />
        </inertial>
    </xacro:macro>
    <xacro:macro name="default_transmission" params="number">
        <transmission name="transmission_${number}">
            <plugin>transmission_interface/SimpleTransmission</plugin>
            <actuator name="motor_${number}" role="actuator1"/>
            <joint name="joint_${number}"    role="joint1">
                <mechanical_reduction>1.0</mechanical_reduction>
            </joint>
        </transmission>
    </xacro:macro>

	<link name="world"/>
	<link name="base_link">
		<xacro:default_inertial mass="0.1"/>
		<visual>
			<origin rpy="0 0 0" xyz="0.25 0.25 0"/>
			<geometry>
				<mesh filename="package://arduinobot_description/meshes/basement.stl" scale="6 6 6"/>
			</geometry>
		</visual>
		<collision>
            <origin rpy="0 0 0" xyz="0.25 0.25 0"/>
			<geometry>
				<mesh filename="package://arduinobot_description/meshes/basement.stl" scale="6 6 6"/>
			</geometry>
        </collision>
	</link>

	<link name="primeiro_elo">
		<xacro:default_inertial mass="0.1"/>
		<visual>
			<origin rpy="0 0 0" xyz="0.25 0.57 0"/>
			<geometry>
				<mesh filename="package://arduinobot_description/meshes/manipulator_elo1.stl" scale="6 6 6"/>
			</geometry>
		</visual>
		<collision>
            <origin rpy="0 0 0" xyz="0.25 0.57 0"/>
			<geometry>
				<mesh filename="package://arduinobot_description/meshes/manipulator_elo1.stl" scale="6 6 6"/>
			</geometry>
        </collision>
	</link>

	<link name="segundo_elo">
		<xacro:default_inertial mass="0.1"/>
		<visual>
			<origin rpy="0 0 0" xyz="0.3 0.6 -0.55"/>
			<geometry>
				<mesh filename="package://arduinobot_description/meshes/manipulator_elo2.stl" scale="6 6 6"/>
			</geometry>
		</visual>
		<collision>
			<origin rpy="0 0 0" xyz="0.3 0.6 -0.55"/>
			<geometry>
				<mesh filename="package://arduinobot_description/meshes/manipulator_elo2.stl" scale="6 6 6"/>
			</geometry>
		</collision>
	</link>

	<link name="terceiro_elo">
		<xacro:default_inertial mass="0.1"/>
		<visual>
			<origin rpy="0 0 0" xyz="0.25 0.6 -1.18"/>
			<geometry>
				<mesh filename="package://arduinobot_description/meshes/manipulator_elo3.stl" scale="6 6 6"/>
			</geometry>
		</visual>
		<collision>
			<origin rpy="0 0 0" xyz="0.25 0.6 -1.18"/>
			<geometry>
				<mesh filename="package://arduinobot_description/meshes/manipulator_elo3.stl" scale="6 6 6"/>
			</geometry>
		</collision>
	</link>

	<link name="quarto_elo">
		<xacro:default_inertial mass="0.1"/>
		<visual>
			<origin rpy="0 0 0" xyz="0.25 -0.187 -1.18"/>
			<geometry>
				<mesh filename="package://arduinobot_description/meshes/manipulator_elo4.stl" scale="6 6 6"/>
			</geometry>
		</visual>
		<collision>
			<origin rpy="0 0 0" xyz="0.25 -0.187 -1.18"/>
			<geometry>
				<mesh filename="package://arduinobot_description/meshes/manipulator_elo4.stl" scale="6 6 6"/>
			</geometry>
		</collision>
	</link>

	<link name="base_garra">
		<xacro:default_inertial mass="0.1"/>
		<visual>
			<origin rpy="0 0 ${PI/2}" xyz="0 0 0"/>
			<geometry>
				<mesh filename="package://arduinobot_description/meshes/base_garra.stl" scale="6 6 6"/>
			</geometry>
		</visual>
		<collision>
			<origin rpy="0 0 ${PI/2}" xyz="0 0 0"/>
			<geometry>
				<mesh filename="package://arduinobot_description/meshes/base_garra.stl" scale="6 6 6"/>
			</geometry>
		</collision>
	</link>

	<link name="garra_elo1">
		<xacro:default_inertial mass="0.1"/>
		<visual>
			<origin rpy="0 ${PI} -${PI/2}" xyz="0.07 -0.15 0.05"/>
			<geometry>
				<mesh filename="package://arduinobot_description/meshes/garra_elo1.stl" scale="6 6 6"/>
			</geometry>
		</visual>
		<collision>
			<origin rpy="0 ${PI} -${PI/2}" xyz="0.07 -0.15 0.05"/>
			<geometry>
				<mesh filename="package://arduinobot_description/meshes/garra_elo1.stl" scale="6 6 6"/>
			</geometry>
		</collision>
	</link>

	<link name="garra_elo2a">
		<xacro:default_inertial mass="0.1"/>
		<visual>
			<origin rpy="0 0 0" xyz="-0.403 0.133 0"/>
			<geometry>
				<mesh filename="package://arduinobot_description/meshes/garra_elo2.stl" scale="6 6 6"/>
			</geometry>
		</visual>
		<collision>
			<origin rpy="0 0 0" xyz="-0.403 0.133 0"/>
			<geometry>
				<mesh filename="package://arduinobot_description/meshes/garra_elo2.stl" scale="6 6 6"/>
			</geometry>
		</collision>
	</link>

	<link name="garra_elo3a">
		<xacro:default_inertial mass="0.1"/>
		<visual>
			<origin rpy="0 ${PI} 0" xyz="0.28 0.205 0"/>
			<geometry>
				<mesh filename="package://arduinobot_description/meshes/garra_pinca.stl" scale="6 6 6"/>
			</geometry>
		</visual>
		<collision>
			<origin rpy="0 ${PI} 0" xyz="0.28 0.205 0"/>
			<geometry>
				<mesh filename="package://arduinobot_description/meshes/garra_pinca.stl" scale="6 6 6"/>
			</geometry>
		</collision>
	</link>

	<link name="garra_elo2">
		<xacro:default_inertial mass="0.1"/>
		<visual>
			<origin rpy="0 0 ${PI/2}" xyz="-0.07 -0.15 -0.03"/>
			<geometry>
				<mesh filename="package://arduinobot_description/meshes/garra_elo1.stl" scale="6 6 6"/>
			</geometry>
		</visual>
		<collision>
			<origin rpy="0 0 ${PI/2}" xyz="-0.07 -0.15 -0.03"/>
			<geometry>
				<mesh filename="package://arduinobot_description/meshes/garra_elo1.stl" scale="6 6 6"/>
			</geometry>
		</collision>
	</link>

	<link name="garra_elo2b">
		<xacro:default_inertial mass="0.1"/>
		<visual>
			<origin rpy="0 0 ${PI}" xyz="0.273 -0.036 0"/>
			<geometry>
				<mesh filename="package://arduinobot_description/meshes/garra_elo2.stl" scale="6 6 6"/>
			</geometry>
		</visual>
		<collision>
			<origin rpy="0 0 ${PI}" xyz="0.273 -0.036 0"/>
			<geometry>
				<mesh filename="package://arduinobot_description/meshes/garra_elo2.stl" scale="6 6 6"/>
			</geometry>
		</collision>
	</link>
	
	<link name="garra_elo3b">
		<xacro:default_inertial mass="0.1"/>
		<visual>
			<origin rpy="0 0 0" xyz="-0.285 0.205 0"/>
			<geometry>
				<mesh filename="package://arduinobot_description/meshes/garra_pinca.stl" scale="6 6 6"/>
			</geometry>
		</visual>
		<collision>
			<origin rpy="0 0 0" xyz="-0.285 0.205 0"/>
			<geometry>
				<mesh filename="package://arduinobot_description/meshes/garra_pinca.stl" scale="6 6 6"/>
			</geometry>
		</collision>
	</link>

	<!-- JOINTS -->

	<joint name="virtual_joint" type="fixed">
		<parent link="world"/>
		<child link="base_link"/>
		<origin rpy="0 0 0" xyz="0 0 0"/>
	</joint>

	<joint name="joint_1" type="revolute">
		<parent link="base_link"/>
		<child link="primeiro_elo"/>
		<axis xyz="0 0 1"/>
		<origin rpy="0 0 0" xyz="0 -0.23 -0.01"/>
		<limit lower="-${PI/2}" upper="${PI/2}" effort="${effort}" velocity="${velocity}"/>
	</joint>

	<joint name="joint_2" type="revolute">
		<parent link="primeiro_elo"/>
		<child link="segundo_elo"/>
		<axis xyz="1 0 0"/>
		<origin rpy="0 0 0" xyz="-0.05 -0.03 0.57"/>
		<limit lower="-${PI/2}" upper="${PI/2}" effort="${effort}" velocity="${velocity}"/>
	</joint>

	<joint name="joint_3" type="revolute">
		<parent link="segundo_elo"/>
		<child link="terceiro_elo"/>
		<axis xyz="1 0 0"/>
		<origin rpy="0 0 0" xyz="0.06 0 0.63"/>
		<limit lower="-${PI/2}" upper="${PI/2}" effort="${effort}" velocity="${velocity}"/>
	</joint>

	<joint name="joint_4" type="revolute">
		<parent link="terceiro_elo"/>
		<child link="quarto_elo"/>
		<axis xyz="1 0 0"/>
		<origin rpy="0 0 0" xyz="0 0.78 0"/>
		<limit lower="-${PI/2}" upper="${PI/2}" effort="${effort}" velocity="${velocity}"/>
	</joint>

	<joint name="joint_5" type="revolute">
		<parent link="quarto_elo"/>
		<child link="base_garra"/>
		<axis xyz="0 1 0"/>
		<origin rpy="0 0 0" xyz="0.02 0.36 0"/>
		<limit lower="-${PI/2}" upper="${PI/2}" effort="${effort}" velocity="${velocity}"/>
	</joint>

	<joint name="joint_6" type="revolute">
		<parent link="base_garra"/>
		<child link="garra_elo1"/>
		<axis xyz="0 0 1"/>
		<origin rpy="0 0 0" xyz="-0.072 0.12 0.01"/>
		<limit lower="-${40*PI/180}" upper="${30*PI/180}" effort="${effort}" velocity="${velocity}"/>
	</joint>

	<joint name="joint_garra_1" type="revolute">
		<parent link="base_garra"/>
		<child link="garra_elo2a"/>
		<axis xyz="0 0 1"/>
		<origin rpy="0 0 0" xyz="-0.05 0.27 0.01"/>
		<mimic joint="joint_6" multiplier="1" offset="-0.2" />
		<limit lower="-${PI/2}" upper="${PI/2}" effort="${effort}" velocity="${velocity}"/>
	</joint>

	<joint name="joint_pinca_a" type="revolute">
		<parent link="garra_elo1"/>
		<child link="garra_elo3a"/>
		<axis xyz="0 0 1"/>
		<origin rpy="0 0 -${PI/2}" xyz="-0.13 0.13 0"/>
		<mimic joint="joint_6" multiplier="-1" offset="0.2" />
		<limit effort="${effort}" velocity="${velocity}"/>
	</joint>

	<joint name="joint_7" type="revolute">
		<parent link="base_garra"/>
		<child link="garra_elo2"/>
		<axis xyz="0 0 1"/>
		<origin rpy="0 0 0" xyz="+0.072 0.12 0.01"/>
		<mimic joint="joint_6" multiplier="-1" offset="0" />
		<limit lower="-${30*PI/180}" upper="${30*PI/180}" effort="${effort}" velocity="${velocity}"/>
	</joint>

	<joint name="joint_garra_3" type="revolute">
		<parent link="base_garra"/>
		<child link="garra_elo2b"/>
		<axis xyz="0 0 1"/>
		<origin rpy="0 0 0" xyz="+0.04 0.27 0.01"/>
		<mimic joint="joint_6" multiplier="-1" offset="-1.6708" />
		<limit lower="-${PI/2}" upper="${PI/2}" effort="${effort}" velocity="${velocity}"/>
	</joint>

	<joint name="joint_pinca_b" type="revolute">
		<parent link="garra_elo2"/>
		<child link="garra_elo3b"/>
		<axis xyz="0 0 1"/>
		<origin rpy="0 0 ${PI/2}" xyz="0.13 0.13 0"/>
		<mimic joint="joint_6" multiplier="1" offset="-0.2" />
		<limit effort="${effort}" velocity="${velocity}"/>
	</joint>

	<!-- Transmissions-->
    <xacro:default_transmission number="1"/>
    <xacro:default_transmission number="2"/>
    <xacro:default_transmission number="3"/>
    <xacro:default_transmission number="4"/>

</robot>